<html>
<script>
	const clamp = (num, min, max) => Math.min(Math.max(num, min), max);
	function acc2mot(a, o) {
		//console.log(a.x,a.y,a.z)
		var lm = clamp(Math.round((-a.y-a.x) * 25), -255, 255)
		var rm = clamp(Math.round((-a.y+a.x) * 25), -255, 255)
		o[2] |= ((lm < 0) ? 1 : 0) << 0
		o[2] |= ((rm < 0) ? 1 : 0) << 1
		o[0] = Math.abs(lm)
		o[1] = Math.abs(rm)
	}
	function sendData() {
		sendBuff.fill(0)
		acc2mot(acceldata.accelerationIncludingGravity, sendBuff)
		console.log(sendBuff[0], sendBuff[1], sendBuff[2])
		oe.innerText = `${sendBuff[0].toString()} ${sendBuff[1].toString()} ${sendBuff[2].toString()}`
	}
	var oe
	var websocket
	var acceldata
	var sendBuff = new Uint8Array(3)
	window.onload = function() {
		oe = document.getElementById("owo")
	}
	function startup() {
		websocket = new WebSocket(`ws://${window.location.hostname}/ws`);
		var el = document.getElementById("canvas");
		el.addEventListener("touchstart", handleStart, false);
		el.addEventListener("touchend", handleEnd, false);
		el.addEventListener("touchcancel", handleCancel, false);
		el.addEventListener("touchmove", handleMove, false);
		
	}

	document.addEventListener("DOMContentLoaded", startup);
</script>
<body>
	<button onclick="document.documentElement.requestFullscreen()">Fullscr</button>
</body>
</html>